---
title: "Plots"
author: "Owen Fiore"
date: "2022-12-09"
output: html_document
---

```{r}
times <- read.csv("../Data/Thesis2023.csv")
colnames(times) <- c("Year", "Type", "Time", "RxnTime", "Gender", "Batch")
```

```{r}
with2022 <- subset(times, (Type == "F" | Type == "S") & Gender == "M" & Time != 'DQ')
library(ggplot2)
ggplot(with2022, aes(x = Year, y = RxnTime, group = Year)) +
  geom_boxplot() +
  labs(x = "Year", y = "Reaction Time (s)") +
       scale_y_continuous(limits = c(0.1, 0.225),
                            breaks = seq(0.1, 0.225, 0.025)) +
  expand_limits(y = 0.1) + scale_x_continuous(limits = c(1998,2024),
                                              breaks = seq(1999, 2024, 2))
ggsave(filename="Boxplot.pdf", path = "../Manuscript", height = 4, width = 6)
```



```{r}
library(tidyr)
library(ggplot2)
nineteen <- read.csv("../Data/2019vs2022.csv")
#"C:\Users\ofior\Documents\Thesis\Data\2019vs2022.csv"
colnames(nineteen) <- c("Athlete", "Country", "2019 Heats", "2019 Semifinals", "2019 Finals", "2022 Heats", "2022 Semifinals", "2022 Finals")
nineteen <- nineteen[, -c(1,2)]
df_long <- tidyr::pivot_longer(nineteen, cols = everything(), names_to = "Column", values_to = "Time")
df_long$Column <- factor(df_long$Column, levels = c("2019 Heats", "2019 Semifinals", "2019 Finals", "2022 Heats", "2022 Semifinals", "2022 Finals"))
rank1 <- ggplot(df_long, aes(x = Column, y = Time)) +
  geom_point() +
  labs(y = "Reaction Time", x = "") +
  annotate("text", y = 0.21, x = "2022 Semifinals", label = "2019 vs 2022", cex = 5) +
  ylim(0.08, 0.22) +
  theme_minimal()
```

```{r}
library(tidyr)
library(ggplot2)
twentythree <- read.csv("../Data/2022vs2023.csv")
#"C:\Users\ofior\Documents\Thesis\Data\2019vs2022.csv"
colnames(twentythree) <- c("Athlete", "Country", "2022 Heats", "2022 Semifinals", "2022 Finals", "2023 Heats", "2023 Semifinals", "2023 Finals")
twentythree <- twentythree[, -c(1,2)]
df_long <- tidyr::pivot_longer(twentythree, cols = everything(), names_to = "Column", values_to = "Time")
df_long$Column <- factor(df_long$Column, levels = c("2022 Heats", "2022 Semifinals", "2022 Finals", "2023 Heats", "2023 Semifinals", "2023 Finals"))
rank2 <- ggplot(df_long, aes(x = Column, y = Time)) +
  geom_point() +
  labs(y = "Reaction Time", x = "") +
  annotate("text", y = 0.21, x = "2023 Semifinals", label = "2022 vs 2023", cex = 5) +
  ylim(0.08, 0.22) +
  theme_minimal()
```

```{r}
library(tidyr)
library(ggplot2)
national <- read.csv("../Data/NatVSWorld.csv")
#"C:\Users\ofior\Documents\Thesis\Data\2019vs2022.csv"
colnames(national) <- c("Athlete", "Country", "Nat. Heats", "Nat. Semifinals", "Nat. Finals", "Inter. Heats", "Inter. Semifinals", "Inter. Finals", "Data Source")
national <- national[, -c(1,2, 9)]
df_long <- tidyr::pivot_longer(national, cols = everything(), names_to = "Column", values_to = "Time")
df_long$Column <- factor(df_long$Column, levels = c("Nat. Heats", "Nat. Semifinals", "Nat. Finals", "Inter. Heats", "Inter. Semifinals", "Inter. Finals"))
rank3 <- ggplot(df_long, aes(x = Column, y = Time)) +
  geom_point() +
  labs(y = "Reaction Time", x = "") +
  ylim(0.08, 0.22) +
  annotate("text", y = 0.21, x = "Inter. Semifinals", label = "2022 National vs International", cex = 5) +
  theme_minimal()
```

```{r}
library(gridExtra)
rank_scatter <- grid.arrange(rank1, rank2, rank3, ncol = 1)
ggsave(filename = "RankScatterPlots.pdf", path = "../Manuscript", plot=rank_scatter, height = 7.5, width = 7)
```


